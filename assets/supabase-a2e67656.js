import{c as g}from"./@supabase-9ce37a4a.js";import{p as d}from"./pica-f1c996d9.js";const h="https://yrmvpuhcbcgqqvvbvkcg.supabase.co",w="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlybXZwdWhjYmNncXF2dmJ2a2NnIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxMjMyNzAwNiwiZXhwIjoyMDI3OTAzMDA2fQ.tgOuygVMSIw38RL9I5Fz-AY7rSFHhtcLV5e4UdHXANE",c=g(h,w),f=async a=>{const e=document.createElement("img"),r=document.createElement("canvas"),o=d();return new Promise((t,s)=>{const n=new FileReader;n.onload=l=>{e.src=l.target.result,e.onload=async()=>{r.width=300,r.height=300;try{const i=await o.resize(e,r,{unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:2}),m=await o.toBlob(i,"image/jpeg",.8);t(m)}catch(i){s(i)}}},n.onerror=s,n.readAsDataURL(a)})},p=async(a,e)=>{const r=await f(a),o=`${e}`,{data:t,error:s}=await c.storage.from("avatars").upload(o,r);if(s)throw console.error("Error al subir el archivo:",s.message),s;return`${h}/storage/v1/object/public/avatars/${o}`},F=a=>`${h}/storage/v1/object/public/avatars/${a}`,I=async(a,e)=>{const r=`${e}`,{error:o}=await c.storage.from("avatars").remove([r]);if(o)throw console.error("Error al eliminar el archivo existente:",o.message),o;return await p(a,e)},$=async(a,e)=>{try{const r=a.name;let o=`${e}/${r}`;console.log("Subiendo archivo con nombre:",o);const{data:t,error:s}=await c.storage.from("audio_avance").upload(o,a);if(s)throw console.error("Error al subir el archivo:",s.message),s;const n=`${h}/storage/v1/object/public/audio_avance/${o}`;return console.log("Archivo subido exitosamente:",n),n}catch(r){throw console.error("Error en uploadAudio:",r),r}},v=async a=>{const e=document.createElement("img"),r=document.createElement("canvas"),o=d();return new Promise((t,s)=>{const n=new FileReader;n.onload=l=>{e.src=l.target.result,e.onload=async()=>{r.width=e.width,r.height=e.height;try{let i=.8,m;do{const u=await o.resize(e,r);m=await o.toBlob(u,"image/jpeg",i),i-=.1}while(m.size>2e5&&i>.1);t(m)}catch(i){s(i)}}},n.onerror=s,n.readAsDataURL(a)})},E=async(a,e)=>{try{const r=await v(a),o=a.name,t=`${e}/${o}`;console.log("Subiendo archivo con nombre:",t);const{data:s,error:n}=await c.storage.from("images").upload(t,r);if(n)throw console.error("Error al subir el archivo:",n.message),n;const l=`${h}/storage/v1/object/public/images/${t}`;return console.log("Archivo subido exitosamente:",l),l}catch(r){throw console.error("Error en uploadImage:",r),r}},N=async(a,e)=>{try{const{data:r,error:o}=await c.storage.from(e).list(a,{limit:100,offset:0});if(o)throw console.error("Error al listar los archivos:",o.message),o;return r}catch(r){throw console.error("Error en listFilesInFolder:",r),r}},A=async(a,e,r)=>{try{const o=`${a}/${r.name}`;let{error:t}=await c.storage.from(e).upload(o,r);if(t)throw t}catch(o){console.error("Error uploading file:",o)}},z=async(a,e,r)=>{try{const o=`${a}/${r}`,{error:t}=await c.storage.from(e).remove([o]);if(t)throw t}catch(o){console.error("Error deleting file:",o)}},J=async(a,e)=>{try{const{data:r,error:o}=await c.storage.from(e).list(a);if(o)throw console.error("Error al listar los archivos:",o.message),o;if(r.length===0){console.log("No hay archivos para eliminar en la carpeta:",e);return}const t=r.map(n=>`${a}/${n.name}`);console.log("Archivos a eliminar:",t);const{error:s}=await c.storage.from(e).remove(t);if(s)throw console.error("Error al eliminar los archivos:",s.message),s}catch(r){throw console.error("Error en deleteFilesInFolder:",r),r}},S=async(a,e,r)=>{try{const o=`${a}/${e}.json`;let{error:t}=await c.storage.from("reporte").upload(o,r);if(t)throw t}catch(o){throw console.error("Error uploading file:",o),o}},j=async(a,e)=>{try{const r=`${a}/${e}.json`,{data:o,error:t}=await c.storage.from("reporte").download(r);if(t)throw t;return o}catch(r){throw console.error("Error fetching JSON file:",r),r}},P=async(a,e)=>{try{const r=`${a}/${e}.json`,{error:o}=await c.storage.from("reporte").remove([r]);if(o)throw o;return!0}catch(r){throw console.error("Error deleting JSON file:",r),r}};export{$ as a,E as b,A as c,z as d,J as e,j as f,F as g,P as h,S as i,N as l,I as r,p as u};
